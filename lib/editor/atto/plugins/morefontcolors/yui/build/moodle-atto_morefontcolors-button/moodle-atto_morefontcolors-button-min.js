YUI.add("moodle-atto_morefontcolors-button",function(e,t){var n='<form id="atto_morefontcolors_dialogue"><div class="picker"><div id="atto_morefontcolors_dialogue_hue-dial"></div><div class="sliders"><div id="atto_morefontcolors_dialogue_sat-slider"><strong>{{get_string "saturation" component}}<span></span></strong></div><div id="atto_morefontcolors_dialogue_lum-slider"><strong>{{get_string "luminance" component}}<span></span></strong></div></div><div class="color"></div></div><div class="yui3-g picker-output"><div class="yui3-u-1-3"><strong>{{get_string "hexadecimal" component}}</strong><input type="text" id="atto_morefontcolors_dialogue_hex-output"></div><div class="yui3-u-1-3"><strong>{{get_string "rgb" component}}</strong><input type="text" id="atto_morefontcolors_dialogue_rgb-output"></div><div class="yui3-u-1-3"><strong>{{get_string "hsl" component}}</strong><input type="text" id="atto_morefontcolors_dialogue_hsl-output"></div></div><div class="mdl-align"><button type="submit" class="submit">{{get_string "submit" component}}</button></div></form>';e.namespace("M.atto_morefontcolors").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{_currentSelection:null,_content:null,initializer:function(t){var n=[],r=this.get("colors");e.Array.each(r,function(e){if(e.trim()){var t=e.split(/\s+/),r="";for(var i=0;i<t.length;i++){var s=t[i].trim();/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(s)&&(r=r+'<div style="width: 20px; margin-right: 5px; height: 20px; border: 1px solid #CCC; background-color: '+s+'" data-color="'+s+'"></div>')}n.push({text:r,callback:this._changeStyle})}}),t.allowcustom==="1"&&n.push({text:'<div style="width: 20px; height: 20px; border: 1px solid #CCC;" id="atto_morefontcolors_customicon"></div>',callbackArgs:"custom",callback:this._changeStyle}),this.addToolbarMenu({icon:"e/text_color",overlayWidth:"4",menuColor:"#333333",globalItemConfig:{inlineFormat:!0,callback:this._changeStyle},items:n})},_changeStyle:function(e,t){t==="custom"?this._customColor():this.get("host").formatSelectionInlineStyle({color:e.target.getAttribute("data-color")})},_customColor:function(){var t=e.Handlebars.compile(n),r=this.getDialogue({headerContent:M.util.get_string("customcolor","atto_morefontcolors"),width:"470px",focusAfterHide:!0});this._currentSelection=this.get("host").getSelection(),this._content=e.Node.create(t({component:"atto_morefontcolors"})),r.set("bodyContent",this._content).show(),this._initiateColorPicker(),this._content.one(".submit").on("click",function(t){t.preventDefault(),this.getDialogue({focusAfterHide:null}).hide();var n=e.one("#"+r.get("id")+" #atto_morefontcolors_dialogue_rgb-output").get("value");this.get("host").setSelection(this._currentSelection),this.get("host").formatSelectionInlineStyle({color:n})},this)},_initiateColorPicker:function(){var e=this.getDialogue().get("id"),t="#"+e+" #atto_morefontcolors_dialogue";YUI().use("dial","slider","event-valuechange","color",function(e){e.one(t+" .picker").addClass("yui3-skin-sam");var n=new e.Dial({min:0,max:360,stepsPerRevolution:360,continuous:!0,centerButtonDiameter:.4,render:t+" #atto_morefontcolors_dialogue_hue-dial"}),r=new e.Slider({min:0,max:100,value:100,render:t+" #atto_morefontcolors_dialogue_sat-slider"}),i=new e.Slider({min:0,max:100,value:50,render:t+" #atto_morefontcolors_dialogue_lum-slider"}),s=e.one(t+" #atto_morefontcolors_dialogue_sat-slider span"),o=e.one(t+" #atto_morefontcolors_dialogue_lum-slider span"),u=e.one(t+" .color"),a=e.one(t+" #atto_morefontcolors_dialogue_hex-output"),f=e.one(t+" #atto_morefontcolors_dialogue_rgb-output"),l=e.one(t+" #atto_morefontcolors_dialogue_hsl-output"),c=null,h=function(e){c=e.currentTarget},p=function(e){c===e.currentTarget&&(c=null)},d=function(t){a!==c&&a.set("value",e.Color.toHex(t)),f!==c&&f.set("value",e.Color.toRGB(t)),l!==c&&l.set("value",t)},v=function(e){typeof e.h!="undefined"&&n.set("value",+e.h),typeof e.s!="undefined"&&r.set("value",+e.s),typeof e.l!="undefined"&&i.set("value",+e.l)},m=function(t){var n=t.newVal,r=[];e.Color.toArray(n)&&(r=e.Color.toArray(e.Color.toHSL(n)),v({h:r[0],s:r[1],l:r[2]}))},g=function(){var t=n.get("value"),a=r.get("value"),f=i.get("value"),l=e.Color.fromArray([t,a,f],e.Color.TYPES.HSL),c=e.Color.toHex(l);s.set("text",a+"%"),o.set("text",f+"%"),u.setStyle("backgroundColor",c),d(l)};a.on("focus",h),a.on("blur",p),a.on("valueChange",m),f.on("focus",h),f.on("blur",p),f.on("valueChange",m),l.on("focus",h),l.on("blur",p),l.on("valueChange",m),n.after("valueChange",function(){g()}),r.after("thumbMove",function(){g()}),i.after("thumbMove",function(){o.set("text",i.get("value")+"%"),g()}),g()})}},{ATTRS:{colors:{value:{}}}},{ATTRS:{colors:{value:{}}}})},"@VERSION@");
